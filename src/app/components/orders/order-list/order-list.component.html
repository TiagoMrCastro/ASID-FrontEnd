<app-navbar></app-navbar>
<mat-card>
  <h3>Histórico de Encomendas (CQRS)</h3>

  <mat-form-field>
    <mat-label>Data Início</mat-label>
    <input matInput [(ngModel)]="from" type="date">
  </mat-form-field>

  <mat-form-field>
    <mat-label>Data Fim</mat-label>
    <input matInput [(ngModel)]="to" type="date">
  </mat-form-field>

  <button mat-raised-button color="primary" (click)="fetchOrders()">Filtrar</button>
</mat-card>

<mat-card *ngFor="let order of orders" style="margin-top: 1rem;">
  <mat-card-title>
    Encomenda #{{ order.orderId }} | {{ order.orderDate }}
  </mat-card-title>

  <mat-card-content>
    <p><strong>Total:</strong> {{ order.totalPrice | currency:'EUR' }}</p>
    <p><strong>Morada:</strong> {{ order.shippingAddress }}</p>

    <ng-container>
      <p><strong>Enviado para:</strong> {{ getShippingName(order.shippingAddress) || 'Não disponível' }}</p>
    </ng-container>

    <h4>Livros:</h4>
    <ul>
      <li *ngFor="let book of order.books">
        {{ getBookTitle(book.bookId) }} - {{ book.quantity }}x - {{ book.price | currency:'EUR' }}
      </li>
    </ul>
  </mat-card-content>
</mat-card>


